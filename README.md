# Telegram бот для записи к гадалке

Бот на aiogram 3, теперь запись идёт в порядке очереди: выбираете услугу, отвечаете на вопросы (дата рождения, имя, описание проблемы) — заявка встаёт в очередь, «с вами свяжутся». Токен бота хранится в `.env`.

## Структура (по слоям, ближе к FSD)
- `app/config.py` — конфиг и константы (мастер, услуги, BOT_TOKEN).
- `app/models.py` — сущности (сессия заявки).
- `app/services/` — бизнес-логика (вспомогательные функции).
- `app/texts.py` — тексты и билдеры сообщений.
- `app/keyboards/` — инлайн-клавиатуры (главное меню, выбор услуги).
- `app/handlers/` — роутеры и обработчики.
- `app/storage.py` — очередь заявок (файл `data/queue.json`).
- `app.py` — точка входа, сборка диспетчера.
- `app/handlers/admin.py` — команды админов/модераторов.

## Запуск
1) Скопируйте шаблон окружения и вставьте токен:
```
cp .env.example .env
```
   Отредактируйте `.env`, подставьте `BOT_TOKEN`.
   Добавьте `ADMIN_IDS` и `MODERATOR_IDS` через запятую (Telegram user id).

2) Установите зависимости (Python 3.10+):
```
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate
pip install -r requirements.txt
```

3) Запустите бота:
```
python app.py
```

## Что умеет сейчас
- `/start` — приветствие и подсказка перезапуска.
- «Записаться» — выбор услуги → вопросы (дата рождения, имя, описание) → заявка уходит в очередь; показываем подтверждение и «с вами свяжутся», предоплата остаётся в коммуникации.
- «Мои заявки» — список ваших заявок с их позицией.
- Админка: инлайн-меню `/admin` (фильтры, пагинация, кнопки действий) и команды. Супер-админы могут менять оплату (paid/pending/awaiting_review), сеанс (done/pending), удалять в архив, смотреть оплаченные/неподтверждённые/архив. Модераторы видят списки и чеки, но без смены статусов.
- Очередь хранится в `data/queue.json`.
- Логи в `logs/info.log` (минимум) и `logs/errors.log` (все ошибки), с очисткой после 1000 строк.
